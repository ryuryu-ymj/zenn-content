---
title: "ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã§ PDF æ–‡æ›¸ã‚’ï¼’å€¤ï¼ˆç™½é»’ï¼‰ã«åœ§ç¸®ã™ã‚‹"
emoji: "ğŸ¼"
type: "tech"
topics:
  - "pdf"
  - "åœ§ç¸®"
  - "imagemagick"
  - "pdfimages"
published: true
published_at: "2024-08-28 21:34"
---

ã‚³ãƒ”ãƒ¼æ©Ÿã§ã‚¹ã‚­ãƒ£ãƒ³ã—ãŸ PDF æ–‡æ›¸ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãã„ã®ã§ï¼Œã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã§åœ§ç¸®ã™ã‚‹æ–¹æ³•ã‚’èª¿ã¹ãŸï¼
ä»Šå›ã¯ ImageMagick ã¨ã„ã†ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ç”¨ã„ã¦ï¼Œã‚°ãƒ¬ãƒ¼ã‚¹ã‚±ãƒ¼ãƒ«ã§ã‚¹ã‚­ãƒ£ãƒ³ã—ãŸ PDF æ–‡æ›¸ã‚’ï¼’å€¤ï¼ˆç™½é»’ï¼‰ç”»åƒã§æ§‹æˆã•ã‚ŒãŸ PDF æ–‡æ›¸ã«åœ§ç¸®ã™ã‚‹ï¼

## å¿…è¦ãªã‚‚ã®
* ImageMagick
* pdfimages ï¼ˆã‚ã‚‹ã¨ä¾¿åˆ©ï¼‰

pdfimages ã¯ Popplerï¼ˆã‚ã‚‹ã„ã¯ãã‚Œã‚’ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«ç”¨ã„ãŸ PDF ãƒ“ãƒ¥ãƒ¼ã‚¢ Evince ãªã©ï¼‰ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨ï¼Œä»˜ã„ã¦ãã‚‹ï¼

## ã‚„ã‚Šæ–¹
ã¾ãš pdfimages ã§ PDF æ–‡æ›¸å†…ã®ç”»åƒã®å½¢å¼ã‚„ PPI ã‚’èª¿ã¹ã‚‰ã‚Œã‚‹ï¼

```bash
$ pdfimages -list in.pdf
page   num  type   width height color comp bpc  enc interp  object ID x-ppi y-ppi size ratio
--------------------------------------------------------------------------------------------
   1     0 image    5732  4054  gray    1   8  jpeg   no        25  0   400   400 1384K 6.1%
   2     1 image    5732  4054  gray    1   8  jpeg   no        29  0   400   400 1460K 6.4%
...
```

ä»Šå›ã¯ã‚³ãƒ”ãƒ¼æ©Ÿã§ 400DPIãƒ»ã‚°ãƒ¬ãƒ¼ã‚¹ã‚±ãƒ¼ãƒ«ã«è¨­å®šã—ï¼Œæœ¬ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ãŸï¼ç”»åƒå½¢å¼ã¯ JPEG ã«ãªã£ã¦ã„ã‚‹ï¼

ImageMagick ã§ PDF æ–‡æ›¸ã‚’ä¸€æ—¦ï¼Œ2å€¤ TIFF ç”»åƒã«åœ§ç¸®ã—ï¼Œã•ã‚‰ã« PDF ã«å¤‰æ›ã™ã‚‹ï¼`density` ã«ã¯å…ˆç¨‹èª¿ã¹ãŸ PPI ã‚’æŒ‡å®šã™ã‚Œã°ã‚ˆã„ï¼`compress` ã«æŒ‡å®šã•ã‚Œã¦ã„ã‚‹ `group4` ã¯ï¼’å€¤ç”»åƒç”¨ã®åœ§ç¸®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ï¼ŒFAX ã§åˆ©ç”¨ã•ã‚Œã¦ã„ã‚‹ã‚‰ã—ã„ï¼

```bash
magick -density 400 in.pdf -compress group4 tif:- | magick - out1.pdf
```

```bash
$ pdfimages -list out1.pdf
page   num  type   width height color comp bpc  enc interp  object ID x-ppi y-ppi size ratio
--------------------------------------------------------------------------------------------
   1     0 image    5732  4054  gray    1   1  ccitt  no         8  0   400   400 84.3K 3.0%
   2     1 image    5732  4054  gray    1   1  ccitt  no        22  0   400   400 96.9K 3.4%
...
```

PPI ã¯ãã®ã¾ã¾ï¼Œã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ãŒ JPEG ã‹ã‚‰ CCITTï¼ˆ2å€¤ç”»åƒï¼‰ã«å¤‰æ›ã•ã‚Œã¦ã„ã‚‹ï¼

å½±ã«ã‚ˆã£ã¦æ–‡å­—ãŒæ½°ã‚Œã¦ã—ã¾ã†ã‚ˆã†ãªï¼Œéå‰°ã«é»’ã„å ´åˆã¯é–¾å€¤ `threshold` ã‚’ä¸‹ã’ã‚‹ï¼é€†ã«æ–‡å­—ãŒæ¶ˆãˆã¦ã—ã¾ã†ã‚ˆã†ãªï¼Œéå‰°ã«ç™½ã„å ´åˆã¯ `threshold` ã‚’ä¸Šã’ã‚‹ï¼

```bash
magick -density 400 in.pdf -threshold 40% -compress group4 tif:- | magick - out2.pdf
```

ã•ã‚‰ã«åœ§ç¸®ã—ãŸã„å ´åˆã¯ `density` ã‚’ä¸‹ã’ã‚‹ã¨ï¼ŒPPI ã‚’ä¸‹ã’ã‚‹ã“ã¨ãŒã§ãã‚‹ï¼

```bash
magick -density 200 in.pdf -compress group4 tif:- | magick - out3.pdf
```

```bash
$ pdfimages -list out3.pdf
page   num  type   width height color comp bpc  enc interp  object ID x-ppi y-ppi size ratio
--------------------------------------------------------------------------------------------
   1     0 image    2866  2027  gray    1   1  ccitt  no         8  0   200   200 43.0K 6.1%
   2     1 image    2866  2027  gray    1   1  ccitt  no        22  0   200   200 49.5K 7.0%
...
```

## çµæœ

| Size | Name |
| --- | --- |
| 18M | in.pdf |
| 1.2M | out1.pdf |
| 1.2M | out2.pdf |
| 606K | out3.pdf |

PPI ãã®ã¾ã¾ã§åœ§ç¸®ç‡ã¯ 93% ã¨ãªã‚Šï¼Œã‹ãªã‚Šãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’å‰Šæ¸›ã§ããŸï¼